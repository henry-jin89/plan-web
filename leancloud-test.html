<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>LeanCloud é…ç½®æµ‹è¯•</title>
    <script src="leancloud-config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.15.0/dist/av-min.js"></script>
</head>
<body>
    <h1>LeanCloud é…ç½®æµ‹è¯•</h1>
    <div id="result" style="padding: 20px; font-family: monospace;"></div>

    <script>
        const resultDiv = document.getElementById('result');
        
        function log(message, type = 'info') {
            const colors = {
                info: '#2196f3',
                success: '#4caf50',
                error: '#f44336',
                warning: '#ff9800'
            };
            resultDiv.innerHTML += `<div style="color: ${colors[type]}; margin: 5px 0;">${message}</div>`;
            console.log(message);
        }

        async function testLeanCloud() {
            try {
                log('ğŸš€ å¼€å§‹æµ‹è¯• LeanCloud é…ç½®...', 'info');
                
                // åˆå§‹åŒ–
                log('ğŸ“¦ é…ç½®ä¿¡æ¯:', 'info');
                log(`  - AppID: ${leancloudConfig.appId}`, 'info');
                log(`  - Server: ${leancloudConfig.serverURL}`, 'info');
                
                AV.init({
                    appId: leancloudConfig.appId,
                    appKey: leancloudConfig.appKey,
                    serverURL: leancloudConfig.serverURL
                });
                
                log('âœ… LeanCloud åˆå§‹åŒ–æˆåŠŸ', 'success');
                
                // æµ‹è¯•è¿æ¥
                log('ğŸ” æµ‹è¯•æ•°æ®åº“è¿æ¥...', 'info');
                
                const TestObject = AV.Object.extend('TestConnection');
                const testObj = new TestObject();
                testObj.set('message', 'Hello LeanCloud');
                testObj.set('timestamp', new Date());
                
                await testObj.save();
                log('âœ… æ•°æ®å†™å…¥æˆåŠŸï¼ObjectId: ' + testObj.id, 'success');
                
                // å°è¯•è¯»å–
                const query = new AV.Query('TestConnection');
                const result = await query.first();
                if (result) {
                    log('âœ… æ•°æ®è¯»å–æˆåŠŸï¼', 'success');
                    log('  - Message: ' + result.get('message'), 'success');
                }
                
                log('', 'info');
                log('ğŸ‰ LeanCloud é…ç½®å®Œå…¨æ­£å¸¸ï¼Œå¯ä»¥ä½¿ç”¨ï¼', 'success');
                log('', 'info');
                log('ğŸ“ å»ºè®®ï¼šå¯ç”¨ LeanCloud åŒæ­¥ï¼Œé€Ÿåº¦ä¼šæ›´å¿«', 'success');
                
            } catch (error) {
                log('âŒ LeanCloud æµ‹è¯•å¤±è´¥', 'error');
                log('é”™è¯¯ä¿¡æ¯: ' + error.message, 'error');
                log('é”™è¯¯ä»£ç : ' + error.code, 'error');
                
                if (error.code === 401) {
                    log('', 'warning');
                    log('âš ï¸ è®¤è¯å¤±è´¥ï¼Œå¯èƒ½åŸå› ï¼š', 'warning');
                    log('  1. AppID æˆ– AppKey ä¸æ­£ç¡®', 'warning');
                    log('  2. åº”ç”¨å·²è¢«åˆ é™¤æˆ–ç¦ç”¨', 'warning');
                } else if (error.code === 404) {
                    log('', 'warning');
                    log('âš ï¸ æ‰¾ä¸åˆ°èµ„æºï¼Œå¯èƒ½åŸå› ï¼š', 'warning');
                    log('  1. æ•°æ®è¡¨ä¸å­˜åœ¨ï¼ˆç¬¬ä¸€æ¬¡ä½¿ç”¨æ­£å¸¸ï¼‰', 'warning');
                    log('  2. Server URL é…ç½®é”™è¯¯', 'warning');
                } else if (error.code === 403) {
                    log('', 'warning');
                    log('âš ï¸ æƒé™è¢«æ‹’ç»ï¼Œå¯èƒ½åŸå› ï¼š', 'warning');
                    log('  1. Class æƒé™è®¾ç½®è¿‡ä¸¥', 'warning');
                    log('  2. éœ€è¦åœ¨æ§åˆ¶å°å¼€å¯å…¬å¼€è¯»å†™æƒé™', 'warning');
                }
                
                log('', 'info');
                log('ğŸ“– è§£å†³æ–¹æ³•ï¼š', 'info');
                log('1. è®¿é—® LeanCloud æ§åˆ¶å°ï¼šhttps://console.leancloud.cn/', 'info');
                log('2. æ£€æŸ¥åº”ç”¨æ˜¯å¦å­˜åœ¨ä¸”æ­£å¸¸', 'info');
                log('3. æ£€æŸ¥æ•°æ®å­˜å‚¨ â†’ Class æƒé™è®¾ç½®', 'info');
            }
        }

        testLeanCloud();
    </script>
</body>
</html>

