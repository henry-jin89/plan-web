# 🌐 在线验证指南（GitHub Pages）

## 🎯 验证目标

在 **GitHub Pages 在线网站**上验证：手机端修改保存后，电脑端能在 3-10 秒内同步

---

## ⚠️ 重要提示

### 等待 GitHub Pages 部署（首次需要 3-5 分钟）

刚刚推送代码到 GitHub，需要等待 GitHub Pages 自动部署最新版本。

#### 1. 检查部署状态

访问：
```
https://github.com/henry-jin89/plan-web/actions
```

查看：
- 如果有 ✅ 绿色勾号：部署完成
- 如果有 🟡 黄色圆圈：正在部署中
- 如果有 ❌ 红色叉号：部署失败

**等待部署完成后再开始验证！**

#### 2. 强制刷新网站

部署完成后，打开网站时**必须强制刷新**，清除旧版本缓存：

- **电脑**：按 `Ctrl+F5`（Mac: `Cmd+Shift+R`）
- **手机**：下拉刷新页面 2-3 次

---

## 🌐 在线访问地址

**主网站**：
```
https://henry-jin89.github.io/plan-web/
```

**各个页面**：
- 主页：`https://henry-jin89.github.io/plan-web/`
- 日计划：`https://henry-jin89.github.io/plan-web/day_plan.html`
- 周计划：`https://henry-jin89.github.io/plan-web/week_plan.html`
- 测试页面：`https://henry-jin89.github.io/plan-web/sync-test.html`

---

## 📱 方法 1：手机 + 电脑在线验证（最真实）

### 第 1 步：在手机上打开网站

1. 打开手机浏览器（Safari、Chrome 等）

2. 访问日计划页面：
   ```
   https://henry-jin89.github.io/plan-web/day_plan.html
   ```

3. **首次访问必须强制刷新**：
   - iPhone Safari：下拉刷新 2-3 次
   - Android Chrome：下拉刷新 2-3 次

4. **打开手机控制台**（查看日志）：
   - 点击右下角 🐛 图标（Eruda 调试工具）
   - 选择 **Console** 标签
   - 看到日志输出

---

### 第 2 步：在手机上修改并保存数据

1. 在日计划页面修改内容：
   - 添加一个新的待办事项
   - 或修改目标内容
   - **输入一些独特的文字**，例如：`手机端在线测试 12:30`

2. 点击 **保存** 按钮

3. **查看手机控制台日志**（重要！）：
   应该看到：
   ```
   📝 检测到数据变化: planData_day
   ⏰ 立即更新本地修改时间: 2025-10-31T...
   💾 开始上传到 LeanCloud...
   === 同步成功 ===
   ✅ 共同步 X 项数据
   ☁️ 云端时间: 2025-10-31T...
   ```

**如果看到这些日志 ✅ = 手机端上传成功！**

---

### 第 3 步：在电脑上打开网站

1. 打开电脑浏览器

2. 访问日计划页面：
   ```
   https://henry-jin89.github.io/plan-web/day_plan.html
   ```

3. **强制刷新清除缓存**：
   - Windows/Linux：`Ctrl + F5`
   - Mac：`Cmd + Shift + R`

4. **打开浏览器控制台**：
   - Windows/Linux：按 `F12`
   - Mac：按 `Cmd + Option + I`
   - 切换到 **Console** 标签

---

### 第 4 步：测试不同的同步方式

现在进行以下任一操作，观察多久看到更新：

#### ⚡ 测试 A：移动鼠标（预期 3-5 秒）

1. 在电脑的日计划页面上**移动鼠标**
2. 鼠标停止后 2 秒，查看控制台：
   ```
   🖱️ 检测到用户活动，检查云端更新...
   🔍 检查云端是否有新数据...
   🆕 发现云端有新数据！
   📥 从云端恢复数据中，跳过同步触发: planData_day
   ✅ 已拉取云端更新：X 条数据
   ```

3. 右上角显示**绿色通知**："云端数据已更新"

4. **刷新页面**（F5），应该看到手机端输入的内容！

**验证成功**：看到 `手机端在线测试 12:30` ✅

---

#### 🚀 测试 B：切换窗口（预期 0-2 秒）

1. 先切换到其他应用（微信、QQ 等）
2. 再切换回浏览器窗口
3. 查看控制台：
   ```
   🔍 窗口获得焦点，立即检查云端更新...
   🆕 发现云端有新数据！
   ✅ 已拉取云端更新：X 条数据
   ```

4. 几乎**立即**显示更新通知

5. 刷新页面查看

**这是最快的方式！** 🚀

---

#### 📜 测试 C：滚动页面（预期 3-5 秒）

1. 在电脑的日计划页面上**滚动页面**
2. 滚动停止后 2 秒，查看控制台
3. 应该看到：
   ```
   📜 检测到页面滚动，检查云端更新...
   🆕 发现云端有新数据！
   ✅ 已拉取云端更新：X 条数据
   ```

---

#### ⏰ 测试 D：什么都不做（预期 10 秒）

1. 手机保存后，电脑页面**不做任何操作**
2. 等待最多 10 秒
3. 查看控制台：
   ```
   🔄 定期检查云端更新...
   🆕 发现云端有新数据！
   ✅ 已拉取云端更新：X 条数据
   ```

4. 自动显示更新通知

**这是兜底机制！** ✅

---

### ✅ 验证成功的标志

- ✅ 手机控制台看到 "✅ 共同步 X 项数据"
- ✅ 电脑控制台看到 "✅ 已拉取云端更新"
- ✅ 右上角显示绿色通知
- ✅ 刷新后看到手机端输入的内容
- ✅ 同步延迟在 3-10 秒内（有活动时 3-5 秒）

---

## 🧪 方法 2：使用在线测试页面（更直观）

### 第 1 步：在手机上打开测试页面

```
https://henry-jin89.github.io/plan-web/sync-test.html
```

**强制刷新**（下拉刷新 2-3 次）

---

### 第 2 步：在手机上输入测试数据

1. 输入**标题**：`在线手机测试`
2. 输入**内容**：`这是从手机在线保存的数据`
3. 点击 **"💾 保存到云端"** 按钮
4. 观察**同步状态面板**：
   - 连接状态：应该显示 "✅ 已连接"
   - 本地数据：显示 "1 条"
5. 查看**操作日志**：
   ```
   [时间] 保存测试数据: 在线手机测试
   [时间] 等待同步到云端...
   ```

---

### 第 3 步：在电脑上打开测试页面

```
https://henry-jin89.github.io/plan-web/sync-test.html
```

**强制刷新**（Ctrl+F5 或 Cmd+Shift+R）

---

### 第 4 步：在电脑上检查更新

**方式 1：手动检查（推荐）**

1. 点击 **"🔍 检查更新"** 按钮
2. 观察**操作日志**：
   ```
   [时间] 检查云端更新...
   [时间] 加载测试数据: 在线手机测试 (时间)
   [时间] 来自设备: (手机信息)
   ```
3. 标题和内容框中应该显示手机输入的数据！✅

**方式 2：等待自动同步**

1. 什么都不做，等待 10 秒
2. 应该自动显示更新
3. 点击 **"☁️ 从云端加载"** 查看

---

### ✅ 测试页面验证成功标志

- ✅ 电脑端能看到手机端输入的数据
- ✅ 标题显示："在线手机测试"
- ✅ 内容显示："这是从手机在线保存的数据"
- ✅ 同步状态面板显示最新时间
- ✅ 操作日志无错误

---

## 🔍 方法 3：控制台命令验证（快速检查）

在电脑浏览器控制台输入以下命令：

### 1. 查看同步状态

```javascript
window.leanCloudSync.getStatus()
```

**应该显示**：
```javascript
{
  isInitialized: true,    // ✅ 已初始化
  isEnabled: true,        // ✅ 已启用
  sharedUserId: "shared-plan-web-user",
  lastSync: (最后同步时间),
  syncInProgress: false
}
```

---

### 2. 手动触发检查更新

```javascript
window.leanCloudSync.checkAndPullUpdates()
```

**控制台应该显示**：
```
🔍 检查云端是否有新数据...
(如果有更新) 🆕 发现云端有新数据！
✅ 已拉取云端更新：X 条数据
```

---

### 3. 查看本地保存的数据

```javascript
Object.keys(localStorage).filter(k => k.startsWith('planData_'))
```

**应该显示**：
```javascript
["planData_day", ...]  // 你保存的数据类型
```

---

### 4. 查看具体数据内容

```javascript
JSON.parse(localStorage.getItem('planData_day'))
```

应该能看到手机端保存的数据！

---

## ⚠️ 在线验证常见问题

### 问题 1：控制台没有日志

**可能原因**：
- 页面没有加载最新版本（缓存）
- 需要强制刷新

**解决方法**：
1. **强制刷新页面**：
   - 电脑：`Ctrl+F5` 或 `Cmd+Shift+R`
   - 手机：下拉刷新 2-3 次
2. 清除浏览器缓存：
   - Chrome：设置 → 隐私和安全 → 清除浏览数据
3. 使用**无痕模式**打开：
   - Chrome：`Ctrl+Shift+N`
   - Safari：`Cmd+Shift+N`

---

### 问题 2：手机端看不到 🐛 图标

**可能原因**：
- Eruda 调试工具没有加载
- 页面版本太旧

**解决方法**：
1. 强制刷新页面 2-3 次
2. 清除缓存后重新打开
3. 如果还是没有，检查手机是否是移动设备（Eruda 只在移动设备上显示）

---

### 问题 3：页面顶部状态显示"初始化中..."

**可能原因**：
- LeanCloud 正在连接
- 网络较慢

**解决方法**：
1. 等待 5-10 秒
2. 如果一直显示，刷新页面
3. 检查网络连接

---

### 问题 4：一直看不到更新

**检查清单**：

1. **确认手机端上传成功了吗？**
   - 查看手机控制台
   - 应该有 "✅ 共同步 X 项数据"

2. **确认电脑端加载的是最新版本吗？**
   - 强制刷新：`Ctrl+F5`
   - 查看页面顶部状态指示器

3. **手动触发试试**：
   ```javascript
   // 在电脑控制台运行
   window.leanCloudSync.checkAndPullUpdates()
   ```

4. **查看 GitHub Actions 部署状态**：
   - 访问：`https://github.com/henry-jin89/plan-web/actions`
   - 确认最新提交已部署成功

---

### 问题 5：GitHub Pages 没有更新

**检查部署状态**：

1. 访问 Actions 页面：
   ```
   https://github.com/henry-jin89/plan-web/actions
   ```

2. 查看最新的 workflow：
   - ✅ 绿色 = 部署成功
   - 🟡 黄色 = 正在部署
   - ❌ 红色 = 部署失败

3. 如果部署失败，点击查看详细日志

4. 如果没有自动部署，检查 GitHub Pages 设置：
   ```
   仓库 → Settings → Pages → Source → 选择分支
   ```

---

## 📊 预期同步时间表

| 场景 | 操作 | 预期延迟 |
|------|------|---------|
| **最快** | 切换窗口 | 0-2 秒 🚀 |
| **很快** | 移动鼠标 | 3-5 秒 ⚡ |
| **很快** | 滚动页面 | 3-5 秒 ⚡ |
| **正常** | 无操作（自动检查） | 10 秒 ✅ |

**加上网络延迟**：
- 国内访问 LeanCloud：通常 1-2 秒
- 国内访问 GitHub Pages：通常 2-5 秒

**总延迟** = 同步检测时间 + 网络延迟 + 页面处理时间

---

## ✅ 在线验证成功检查表

完成以下检查，确认同步功能正常：

- [ ] GitHub Actions 显示部署成功 ✅
- [ ] 强制刷新页面清除缓存
- [ ] 手机端能打开在线网站
- [ ] 手机端能保存数据（控制台显示"✅ 共同步"）
- [ ] 电脑端能打开在线网站
- [ ] 电脑端在 10 秒内看到更新（有活动时 3-5 秒）
- [ ] 电脑端控制台显示"✅ 已拉取云端更新"
- [ ] 右上角显示绿色更新通知
- [ ] 刷新后能看到手机端的修改
- [ ] 没有错误日志
- [ ] 没有循环上传问题

**全部打勾 ✅ = 在线同步完美运行！** 🎉

---

## 🎥 完整验证流程（录屏建议）

如果想录制验证视频：

### 时间轴：

```
00:00 - 在手机上打开在线网站
00:10 - 修改计划内容
00:15 - 点击保存，查看控制台日志
00:20 - 看到 "✅ 共同步" ← 手机端成功

00:25 - 在电脑上打开在线网站
00:30 - 强制刷新页面
00:35 - 打开控制台
00:40 - 移动鼠标触发检查
00:43 - 看到 "✅ 已拉取云端更新" ← 电脑端成功
00:45 - 显示绿色更新通知
00:48 - 刷新页面
00:50 - 看到手机端的修改内容 ← 验证成功！✅

总耗时：约 50 秒（实际同步仅 3-5 秒）
```

---

## 🌐 在线访问链接汇总

**主要页面**：
```
主页：https://henry-jin89.github.io/plan-web/
日计划：https://henry-jin89.github.io/plan-web/day_plan.html
周计划：https://henry-jin89.github.io/plan-web/week_plan.html
月计划：https://henry-jin89.github.io/plan-web/month_plan.html
测试页面：https://henry-jin89.github.io/plan-web/sync-test.html
```

**管理页面**：
```
GitHub 仓库：https://github.com/henry-jin89/plan-web
部署状态：https://github.com/henry-jin89/plan-web/actions
```

---

## 🎉 开始在线验证！

### 快速步骤：

1. **等待部署**（首次 3-5 分钟）
   - 检查：https://github.com/henry-jin89/plan-web/actions

2. **手机打开**（强制刷新）
   - 访问：https://henry-jin89.github.io/plan-web/day_plan.html
   - 修改并保存

3. **电脑打开**（强制刷新）
   - 访问：https://henry-jin89.github.io/plan-web/day_plan.html
   - 移动鼠标或等待

4. **查看结果**
   - 3-10 秒内看到更新 ✅

---

**准备好了吗？立即开始在线验证！** 🚀

如果遇到任何问题，请告诉我具体的错误信息或日志，我会帮您解决！

